$(function(){new Vue({el:"html",data:{isLoading:!0,acid:baseJs._getQueryString("activityid"),appos:baseJs._getDeviceInfo(),appkey:baseJs._getQueryString("appkey"),business:baseJs._getQueryString("business"),uid:baseJs._getQueryString("uid"),ua:baseJs.isWeiXin(),i:baseJs._getQueryString("i")||"__IMEI__",f:baseJs._getQueryString("f")||"__IDFA__",showID:baseJs._getQueryString("si"),ipaddress:baseJs._getQueryString("ipaddress"),urlHead:"https://buy.bianxianmao.com",countInterface:"/award/countInfo",times:8,startangel:0,endangel:"",award:[],awardid:"",awardtype:"",floatlinks:"",awardangle:"",awardorderid:"",awardimg:"",ordernum:"",rotateTimer:"",timer:"",activityDesc:"",otherRemark:"",idDelay:!1,collapse:!1,myPrizeLink:"",isShowFailedPanel:!1,success:!1,showHand:!0,turnplate:{colors:["#fde804","#6619be"],bRotate:!1},activityParams:{},btnStatus:"",color:"",color1:"",ZPCount:[]},methods:{_showFailedPanel:function(){this.isShowFailedPanel=!1,this._rotateInit()},_showMoreProbability:function(){this.collapse=!this.collapse},_showNoTimesPanel:function(){baseJs.openDialog({type:"over"})},_init:function(){this._rotateInit(),this.isLoading=!1},_rotateInit:function(){$(".turnplate").stopRotate(),this.endangel=parseFloat(this.startangel+.1),this.endangel>300&&(this.startangel=0,this.endangel=parseFloat(this.startangel+.1)),$(".turnplate").rotate({angle:this.startangel,animateTo:this.endangel,duration:5,callback:function(){this.startangel=this.endangel}.bind(this)}),this.rotateTimer=window.requestAnimationFrame(function(){this._rotateInit()}.bind(this))},_rotate:function(){window.cancelAnimationFrame(this.rotateTimer),$(".turnplate").rotate({angle:this.startangel,animateTo:parseFloat(this.startangel)+1080,duration:3e3,callback:function(){this.startangel=this.endangel}}),this.timer=setTimeout(function(){this._rotate()}.bind(this),200)},_rotateFn:function(t,a){clearTimeout(this.timer),$(".turnplate").rotate({angle:this.startangel,animateTo:parseInt(t)+720,duration:3e3,callback:function(){this.turnplate.bRotate=!1,a()}.bind(this)})},_startWheel:function(t){this.showHand=!1,window.cancelAnimationFrame(this.rotateTimer),0!=this.times?(this.btnStatus=this.activityParams.buttonchange,setTimeout(function(){this.btnStatus=this.activityParams.buttonstart}.bind(this),100),this.turnplate.bRotate||(this._rotate(),this._joinActivity(),this._showAwards())):this._showNoTimesPanel()},_showAwards:function(){this._ZPStatus((new Date).getTime()),this.setRemainTimes();var t=this;this.awardangle=300;try{var a=!!newAwards.ads&&newAwards.ads.shift()}catch(s){var a=!1}if(!a){if(this.isBackupData)var e={s:t.s,type:"none"};else{var e=window.backupData[0];this.isBackupData=!0}return t._rotateFn(t.awardangle,function(){baseJs.openDialog(e)}),!1}baseJs.saveAward(a);var e={item:a,title:a.desc,ticket:a.img,btntext:"\u7acb\u5373\u9886\u53d6",awardlink:a.curl,s:t.s,type:"bingo"};t._rotateFn(t.awardangle,function(){baseJs.openDialog(e)})},_joinActivity:function(){this.turnplate.bRotate=!this.turnplate.bRotate},_ZPStatus:function(t){var a=this,e={ZPIndex:t};a.ZPCount.push(e);var s={};s.data=a.ZPCount;try{localStorage.setItem("statusZPMin"+a.showID,JSON.stringify(s))}catch(t){baseJs.setCookie("statusZPMin"+a.showID,JSON.stringify(s))}},setRemainTimes:function(){var t=null,a=this,e=0,s=null;try{t=localStorage.getItem("statusZPMin"+a.showID)}catch(i){t=baseJs.getCookie("statusZPMin"+a.showID)}s=JSON.parse(t),e=null!=t&&null!=s?s.data.length:e,a.isDateChange()?(a.times=8,baseJs.syncRemains(8)):(a.times=8-e,baseJs.syncRemains(a.times))},isDateChange:function(){var t="",a=this,e=new Date;if(!this.showID)return!1;e=""+e.getFullYear()+(e.getMonth()+1)+e.getDate();try{t=localStorage.getItem("rawDateZPMin"+a.showID)}catch(s){t=baseJs.getCookie("rawDateZPMin"+a.showID)}if(e!=t){try{localStorage.setItem("rawDateZPMin"+a.showID,e),localStorage.removeItem("statusZPMin"+a.showID)}catch(s){baseJs.setCookie("rawDateZPMin"+a.showID,e,1),baseJs.delCookie("statusZPMin"+a.showID)}return!0}return!1}},watch:{award:function(){Vue.nextTick(function(){})}},ready:function(){this._init(),this.setRemainTimes();var t;try{t=localStorage.getItem("statusZPMin"+this.showID)}catch(n){t=baseJs.getCookie("statusZPMin"+this.showID)}if(null!=t){var a=JSON.parse(t).data;this.ZPCount=a}var e=0,s=0,i=this;$(".start").on("mousedown",function(){e=(new Date).getTime()}).on("mouseup",function(){s=(new Date).getTime(),baseJs.adClickPlugin(e,s,i.times),baseJs.syncRemains(i.times)})}})});