!function(e){var t,n,a;a={API_SERVER:"//zhannei-dm.csdn.net/",API_BAIDU_SERVER:"https://gsp0.baidu.com/yrwHcjSl0MgCo2Kml5_Y_D3/",API_KEYWORD_GET_URL:"recommend/baidu_keyword",API_BAIDU_CACHE_URL:"recommend/baidu_zhannei_search",API_STATISTIC_SERVER:"//statistic.csdn.net/",SUB_DOMAIN:["blog.csdn.net","download.csdn.net","bbs.csdn.net","edu.csdn.net","geek.csdn.net"],keyword:"",autorun:!1,install:!0,baiduSearchAPPID:"10742016945123576423",debug:{active:!1,currentUrl:"http://blog.csdn.net/dqcfkyqdxym3f8rb0/article/details/66666666",API_SERVER:"http://devpassport.csdn.net/"}};for(var c in a)"API_SERVER"!=c&&"API_STATISTIC_SERVER"!=c&&"API_BAIDU_SERVER"!=c&&c.indexOf("API")>-1&&(a.debug.active?a[c]=a.debug.API_SERVER+a[c]:a[c]=a.API_SERVER+a[c]);"http:"==window.location.protocol&&(a.API_BAIDU_SERVER="http://zhannei.baidu.com/"),n={getRequest:function(e,t){var n,a,c,r={};switch(t=t||"search"){case"hash":n=e.split("#")[1]||"";break;case"search":n=e.split("?")[1]||"",n=n.split("#")[0]}for(c=n.split("&"),a=0;a<c.length;a++)r[c[a].split("=")[0]]=decodeURI(c[a].split("=")[1]);return r},parseCFG:function(){e("script").each(function(t){var c=e(this).attr("src");if(c&&c.indexOf("baidu_search")>-1){var r=n.getRequest(c);return a.keyword=r.keyword||a.keyword,a.autorun="true"==r.autorun,void(a.install="false"!=r.install)}})},autorun:function(){""!=a.keyword?csdn.baiduSearch(a.keyword,function(e){csdn.baiduCacheBuild(a.keyword,e)}):csdn.baiduKeywordGet(function(e){csdn.baiduSearch(e,function(t){csdn.baiduCacheBuild(e,t)})})},trackByGraylog:function(e,t){},filterData:function(e){var t=[];for(var n in e){var a=e[n];if(!/^((https|http)?:\/\/)(.*)download.csdn.net[^\s]+/.test(a.linkUrl)||/^((https|http)?:\/\/)download.csdn.net\/download\/[^\s]+/.test(a.linkUrl)){var c=a.title;c=c.replace("-<em>CSDN</em>下载",""),c=c.replace("- <em>CSDN</em>下载",""),c=c.replace("-CSDN下载",""),c=c.replace(" - 下载频道 - CSDN.NET",""),c!==a.title,a.title=c,t.push(a)}}return t},removeCurrent:function(e){var t=window.location.href.split("#")[0],n=[];for(var a in e){var c=e[a],r=c.linkUrl.split("?")[0];r!=t&&n.push(c)}return n}},t={baiduSearchInstall:function(e){var t=document.createElement("script");t.type="text/javascript",t.charset="utf-8",t.src=a.API_BAIDU_SERVER+"api/customsearch/apiaccept?sid="+a.baiduSearchAPPID+"&v=2.0&callback=csdn.afterBaiduSearchInit",t.onerror=function(){n.trackByGraylog("baidu_search_error",{step:"install"}),"function"==typeof csdn.baiduSearchInstallError&&csdn.baiduSearchInstallError()};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(t,c)},afterBaiduSearchInit:function(){return csdn.cse=new BCse.Search(a.baiduSearchAPPID),"function"==typeof csdn.afterCasInit?void csdn.afterCasInit(a.keyword,csdn.cse):void(a.autorun&&n.autorun())},baiduSearch:function(e,t,c,r){if(c)if(c.indexOf("/")>-1)csdn.cse.setSearchRange(3,[c.split("/")[1]]);else{var s=c.split(".csdn.net");s.length>1&&(c=s[0]),csdn.cse.setSearchRange(2,[c+".csdn.net"])}else csdn.cse.setSearchRange(2,a.SUB_DOMAIN);r||(r=1),csdn.cse.getResult(e,function(a){n.trackByGraylog("baidu_search_success"),a=n.filterData(a),csdn.baiduCacheBuild(e,a);var c=n.removeCurrent(a);t(c)},r)},baiduKeywordGet:function(t){e.ajax({url:a.API_KEYWORD_GET_URL,type:"GET",contentType:"text/plain;charset=UTF-8",data:{url:a.debug.active?a.debug.currentUrl:window.location.href,result_size:1},success:function(e){e.length>0&&(a.debug.active,t(e[0].keyword))}})},baiduCacheBuild:function(t,n){var c="?keyword="+t;"2"==csdn.cse.param.ct&&csdn.cse.param.cc.indexOf("%26")==-1?c+="&domain_type="+csdn.cse.param.cc.split(".csdn.net")[0]:"3"==csdn.cse.param.ct&&(c+="&url_type="+csdn.cse.param.cc),e.ajax({url:a.API_BAIDU_CACHE_URL+c,type:"POST",dataType:"text",contentType:"text/plain;charset=UTF-8",data:JSON.stringify(n)})},baiduSearchCFG:a},void 0===window.csdn&&(window.csdn={});for(i in t)window.csdn[i]=t[i];n.parseCFG(),a.install&&csdn.baiduSearchInstall()}($);